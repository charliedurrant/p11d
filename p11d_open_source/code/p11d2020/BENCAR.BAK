VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.2#0"; "COMCTL32.OCX"
Object = "{4582CA9E-1A45-11D2-8D2F-00C04FA9DD6F}#1.0#0"; "TCSVTEXT.OCX"
Begin VB.Form F_BenCar 
   Caption         =   "Car Benefits"
   ClientHeight    =   5685
   ClientLeft      =   1680
   ClientTop       =   3015
   ClientWidth     =   8325
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form3"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   5685
   ScaleWidth      =   8325
   Begin VB.CommandButton B_Apply 
      Appearance      =   0  'Flat
      Caption         =   "&Copy Car Details"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Left            =   6360
      TabIndex        =   1
      Top             =   1920
      Width           =   1680
   End
   Begin ComctlLib.ListView LB 
      Height          =   2175
      Left            =   135
      TabIndex        =   0
      Tag             =   "free,font"
      Top             =   135
      Width           =   8055
      _ExtentX        =   14208
      _ExtentY        =   3836
      View            =   3
      LabelEdit       =   1
      Sorted          =   -1  'True
      LabelWrap       =   0   'False
      HideSelection   =   0   'False
      _Version        =   327682
      ForeColor       =   -2147483640
      BackColor       =   -2147483643
      BorderStyle     =   1
      Appearance      =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      NumItems        =   3
      BeginProperty ColumnHeader(1) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
         Key             =   ""
         Object.Tag             =   ""
         Text            =   "Car Reference"
         Object.Width           =   2540
      EndProperty
      BeginProperty ColumnHeader(2) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
         Alignment       =   1
         SubItemIndex    =   1
         Key             =   ""
         Object.Tag             =   ""
         Text            =   "Benefit"
         Object.Width           =   2540
      EndProperty
      BeginProperty ColumnHeader(3) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
         Alignment       =   1
         SubItemIndex    =   2
         Key             =   ""
         Object.Tag             =   ""
         Text            =   "P/Y Value"
         Object.Width           =   2540
      EndProperty
   End
   Begin VB.Frame fmeCar 
      Height          =   3255
      Left            =   135
      TabIndex        =   38
      Top             =   2400
      Width           =   8115
      Begin VB.CommandButton B_TAB 
         Appearance      =   0  'Flat
         Caption         =   "&P46 Details..."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   5880
         TabIndex        =   17
         Top             =   240
         Width           =   1935
      End
      Begin VB.CommandButton B_TAB 
         Appearance      =   0  'Flat
         Caption         =   "&General Details..."
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3960
         TabIndex        =   2
         Top             =   240
         Width           =   1935
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   0
         Left            =   2040
         TabIndex        =   3
         Tag             =   "FREE,FONT"
         Top             =   240
         Width           =   1545
         _ExtentX        =   1323
         _ExtentY        =   476
         BackColor       =   255
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":0000
         Text            =   ""
         TypeOfData      =   3
         AllowEmpty      =   0   'False
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   1
         Left            =   2520
         TabIndex        =   4
         Tag             =   "FREE,FONT"
         Top             =   600
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":001C
         Text            =   "0"
         Minimum         =   "0"
         AllowEmpty      =   0   'False
         TXTAlign        =   2
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   2
         Left            =   2520
         TabIndex        =   5
         Tag             =   "FREE,FONT"
         Top             =   960
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":0038
         Text            =   "6/4/97"
         TypeOfData      =   2
         Maximum         =   "5/4/1998"
         Minimum         =   "6/4/1998"
         AllowEmpty      =   0   'False
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   3
         Left            =   2520
         TabIndex        =   6
         Tag             =   "FREE,FONT"
         Top             =   1320
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":0054
         Text            =   "5/4/98"
         TypeOfData      =   2
         Maximum         =   "5/4/1998"
         Minimum         =   "6/4/1998"
         AllowEmpty      =   0   'False
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   4
         Left            =   2520
         TabIndex        =   7
         Tag             =   "FREE,FONT"
         Top             =   1680
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":0070
         Text            =   "0"
         Maximum         =   "365"
         Minimum         =   "0"
         AllowEmpty      =   0   'False
         TXTAlign        =   2
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   5
         Left            =   2520
         TabIndex        =   8
         Tag             =   "FREE,FONT"
         Top             =   2070
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":008C
         Text            =   "0"
         Minimum         =   "0"
         AllowEmpty      =   0   'False
         TXTAlign        =   2
      End
      Begin TCSValidationText.ValText TB_Data 
         Height          =   285
         Index           =   6
         Left            =   2520
         TabIndex        =   9
         Tag             =   "FREE,FONT"
         Top             =   2520
         Width           =   1065
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MouseIcon       =   "Bencar.frx":00A8
         Text            =   "0"
         Minimum         =   "0"
         AllowEmpty      =   0   'False
         TXTAlign        =   2
      End
      Begin VB.Frame fmeTAB 
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2415
         Index           =   0
         Left            =   3600
         TabIndex        =   39
         Top             =   585
         Width           =   4455
         Begin VB.CommandButton B_Acc 
            Appearance      =   0  'Flat
            Caption         =   "&Accessories..."
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   2760
            TabIndex        =   12
            Top             =   840
            Width           =   1575
         End
         Begin VB.ComboBox CB_BusMiles 
            Appearance      =   0  'Flat
            DataField       =   "BusMiles"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000080&
            Height          =   315
            Left            =   1050
            Style           =   2  'Dropdown List
            TabIndex        =   13
            Tag             =   "free,font"
            Top             =   1200
            Width           =   1635
         End
         Begin VB.CommandButton B_Actual 
            Appearance      =   0  'Flat
            Caption         =   "Actual &Miles..."
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   2760
            TabIndex        =   14
            Top             =   1200
            Width           =   1575
         End
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "Do you want to use the actual miles details?"
            DataField       =   "BusMilesActual"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   285
            Index           =   0
            Left            =   120
            TabIndex        =   15
            Tag             =   "free,font"
            Top             =   1680
            Width           =   4245
         End
         Begin VB.CommandButton B_BenFuel 
            Appearance      =   0  'Flat
            Caption         =   "F&uel Benefit..."
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   2760
            TabIndex        =   16
            Top             =   2040
            Width           =   1575
         End
         Begin TCSValidationText.ValText TB_Data 
            Height          =   315
            Index           =   7
            Left            =   720
            TabIndex        =   10
            Tag             =   "free,font"
            Top             =   0
            Width           =   3615
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            MouseIcon       =   "Bencar.frx":00C4
            Text            =   ""
            TypeOfData      =   3
         End
         Begin TCSValidationText.ValText TB_Data 
            Height          =   315
            Index           =   8
            Left            =   3240
            TabIndex        =   11
            Tag             =   "free,font"
            Top             =   405
            Width           =   1065
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            MouseIcon       =   "Bencar.frx":00E0
            Text            =   "1/8/95"
            TypeOfData      =   2
            AllowEmpty      =   0   'False
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Make"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   7
            Left            =   135
            TabIndex        =   25
            Tag             =   "free,font"
            Top             =   90
            Width           =   615
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Date registered"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Index           =   8
            Left            =   120
            TabIndex        =   26
            Tag             =   "free,font"
            Top             =   495
            Width           =   1110
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Accessories"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   9
            Left            =   105
            TabIndex        =   27
            Tag             =   "free,font"
            Top             =   840
            Width           =   975
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Business miles"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   390
            Index           =   10
            Left            =   105
            TabIndex        =   29
            Tag             =   "free,font"
            Top             =   1155
            Width           =   750
            WordWrap        =   -1  'True
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Fuel Benefit"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   6
            Left            =   105
            TabIndex        =   30
            Tag             =   "free,font"
            Top             =   2040
            Width           =   840
         End
         Begin VB.Label lblAccessories 
            Alignment       =   1  'Right Justify
            BorderStyle     =   1  'Fixed Single
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   1050
            TabIndex        =   28
            Tag             =   "free,font"
            Top             =   840
            Width           =   1575
         End
         Begin VB.Label lblFuel 
            Alignment       =   1  'Right Justify
            BorderStyle     =   1  'Fixed Single
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   1080
            TabIndex        =   31
            Tag             =   "free,font"
            Top             =   2040
            Width           =   1575
         End
      End
      Begin VB.Frame fmeTAB 
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2415
         Index           =   1
         Left            =   3600
         TabIndex        =   40
         Top             =   585
         Visible         =   0   'False
         Width           =   4455
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "Replaced"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   375
            Index           =   1
            Left            =   225
            TabIndex        =   42
            Tag             =   "free,font"
            Top             =   0
            Width           =   1695
         End
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "Force print on P46"
            DataField       =   "ForceP46"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   330
            Index           =   5
            Left            =   2115
            TabIndex        =   37
            Tag             =   "free,font"
            Top             =   2115
            Width           =   1695
         End
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "Print make on P46"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   330
            Index           =   4
            Left            =   225
            TabIndex        =   36
            Tag             =   "free,font"
            Top             =   2115
            Width           =   1695
         End
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "SecondCar"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   285
            Index           =   2
            Left            =   2115
            TabIndex        =   32
            Tag             =   "free,font"
            Top             =   45
            Width           =   1695
         End
         Begin VB.CheckBox Op_Data 
            Alignment       =   1  'Right Justify
            Caption         =   "Replacement"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   375
            Index           =   3
            Left            =   210
            TabIndex        =   33
            Tag             =   "free,font"
            Top             =   315
            Width           =   1695
         End
         Begin VB.ComboBox CB_CARLIST 
            Appearance      =   0  'Flat
            DataField       =   "regreplaced"
            DataSource      =   "DB"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   225
            TabIndex        =   35
            Tag             =   "free,font"
            Text            =   "CB_CARLIST"
            Top             =   945
            Width           =   2265
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Replacement Registration"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   18
            Left            =   2520
            TabIndex        =   47
            Tag             =   "free,font"
            Top             =   675
            Width           =   1830
         End
         Begin VB.Label L_Data 
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Car Replaced"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   17
            Left            =   2520
            TabIndex        =   46
            Tag             =   "FREE,FONT"
            Top             =   945
            Width           =   1770
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Available to"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   16
            Left            =   3015
            TabIndex        =   45
            Tag             =   "free,font"
            Top             =   1440
            Width           =   825
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Replacement Make and model"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   11
            Left            =   225
            TabIndex        =   44
            Tag             =   "free,font"
            Top             =   1440
            Width           =   2175
         End
         Begin VB.Label L_Data 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Replacements Available"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   240
            Index           =   5
            Left            =   225
            TabIndex        =   43
            Tag             =   "free,font"
            Top             =   675
            Width           =   1755
         End
         Begin VB.Label L_Data 
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Replacement Make and Model"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   14
            Left            =   225
            TabIndex        =   41
            Tag             =   "FREE,FONT"
            Top             =   1755
            Width           =   2745
         End
         Begin VB.Label L_Data 
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Available To"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   15
            Left            =   3015
            TabIndex        =   34
            Tag             =   "FREE,FONT"
            Top             =   1755
            Width           =   1215
         End
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Registration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Index           =   0
         Left            =   120
         TabIndex        =   18
         Tag             =   "FREE,FONT"
         Top             =   330
         Width           =   1110
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "List Price "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Index           =   1
         Left            =   120
         TabIndex        =   19
         Tag             =   "FREE,FONT"
         Top             =   690
         Width           =   690
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Available from"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Index           =   2
         Left            =   120
         TabIndex        =   20
         Tag             =   "FREE,FONT"
         Top             =   1050
         Width           =   1350
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Days unavailable"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Index           =   4
         Left            =   120
         TabIndex        =   22
         Tag             =   "FREE,FONT"
         Top             =   1770
         Width           =   1470
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Available to"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   195
         Index           =   3
         Left            =   120
         TabIndex        =   21
         Tag             =   "FREE,FONT"
         Top             =   1410
         Width           =   1350
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Capital contribution towards cost of the car/collected via PAYE"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   390
         Index           =   12
         Left            =   120
         TabIndex        =   23
         Tag             =   "FREE,FONT"
         Top             =   2040
         Width           =   2415
         WordWrap        =   -1  'True
      End
      Begin VB.Label L_Data 
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Actual contribution towards private running costs/collected via PAYE"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   615
         Index           =   13
         Left            =   120
         TabIndex        =   24
         Tag             =   "FREE,FONT"
         Top             =   2520
         Width           =   2280
         WordWrap        =   -1  'True
      End
   End
End
Attribute VB_Name = "F_BenCar"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Implements IBenefitForm2
Implements IFrmGeneral

Public benefit As IBenefitClass

Private mclsResize As New clsFormResize
Private m_bentype As benClass
Private m_InvalidVt As ValText

Private Const L_DES_HEIGHT = 6090
Private Const L_DES_WIDTH = 8445
Private mLastClickIndex As Long

Private Sub B_Actual_Click()
  
  Dim car As clsBenCar
  
  Call DialogToScreen(F_BusMiles, Nothing, 0, Me, CurrentEmployee.benefits.ItemIndex(benefit))
  'if we have any mileage data then check use actual miles
  Set car = benefit
  Call GetMiles(benefit, True)
  If car.Mileage.count Then
    'we have miles thus set the check box
    'which will fo its stuff and set the banding accordingly
    If Op_Data(0).value = vbUnchecked Then Op_Data(0).value = vbChecked
  End If
End Sub

Private Sub B_BenFuel_Click()
  Call DialogToScreen(F_BenFuel, lblFuel, car_FuelBenefit, Me, CurrentEmployee.benefits.ItemIndex(benefit))
End Sub

Private Sub CB_BusMiles_Click()
  Call IFrmGeneral_CheckChanged(CB_BusMiles, True)
End Sub

Private Sub CB_BusMiles_KeyDown(KeyCode As Integer, Shift As Integer)
  CB_BusMiles.Tag = SetChanged
End Sub

Private Sub CB_BusMiles_KeyPress(KeyAscii As Integer)
  'Check for return key - tab to next field
  If KeyAscii = 13 Then Call SendKeys(vbTab)
End Sub

Private Sub CB_CARLIST_Click()
  Call GetReplacementCar(CB_CARLIST.ListIndex)
End Sub

Private Sub CB_CARLIST_KeyPress(KeyAscii As Integer)
  'Check for return key - tab to next field
  If KeyAscii = 13 Then Call SendKeys(vbTab)
End Sub

Private Sub CB_CARLIST_LostFocus()
  Call IFrmGeneral_CheckChanged(CB_CARLIST, True)
End Sub

Private Sub Form_Resize()
  mclsResize.Resize
  Call ColumnWidths(LB, 50, 25, 20)
End Sub

Private Sub CB_BusMiles_LostFocus()
  Call IFrmGeneral_CheckChanged(CB_BusMiles, True)
End Sub

Private Sub B_Acc_Click()
  Call DialogToScreen(F_CarAcc, lblAccessories, car_accessories, Me, CurrentEmployee.benefits.ItemIndex(benefit))
End Sub

Private Sub B_TAB_Click(Index As Integer)
  B_TAB(0).Enabled = Not B_TAB(0).Enabled
  fmeTAB(0).Visible = Not fmeTAB(0).Visible
  B_TAB(1).Enabled = Not B_TAB(1).Enabled
  fmeTAB(1).Visible = Not fmeTAB(1).Visible
  If B_TAB(1).Enabled Then
    B_TAB(1).SetFocus
  Else
    B_TAB(0).SetFocus
  End If
End Sub

Private Sub Form_Load()
  If Not (mclsResize.InitResize(Me, L_DES_HEIGHT, L_DES_WIDTH, DESIGN, , , MDIMain)) Then
    Err.Raise ERR_Application
  End If
  CB_BusMiles.AddItem (S_UNDER2499)
  CB_BusMiles.AddItem (S_2500TO17999)
  CB_BusMiles.AddItem (S_18000PLUS)
  mLastClickIndex = -1
End Sub

Private Sub IBenefitForm2_AddBenefit()
  Dim benCar As clsBenCar
  Dim ben As IBenefitClass
  Dim lst As ListItem
  Dim I As Long
  Dim ibf As IBenefitForm2
  
On Error GoTo AddBenefit_Err

  Call xSet("AddBenefit")
  
  Set benCar = New clsBenCar
  Set ben = benCar
  
  Set ben.Parent = CurrentEmployee
  
  Call ben.SetItem(car_employeeref, CurrentEmployee.PersonelNo)
  Call ben.SetItem(car_Registration, "Please enter registration...")
  Call ben.SetItem(car_ListPrice, 0)
  Call ben.SetItem(car_Unavailabledays, 0)
  Call ben.SetItem(car_capitalcontribution, 0)
  Call ben.SetItem(car_usagecontribution, 0)
  Call ben.SetItem(car_CheapAccessories, 0)
  Call ben.SetItem(car_OriginalAccessories, 0)
  Call ben.SetItem(car_NewAccessories, 0)
  Call ben.SetItem(car_Enginesize, 0)
  Call ben.SetItem(car_Availablefrom, rates.GetItem(taxyearstart))
  Call ben.SetItem(car_Availableto, rates.GetItem(taxyearend))
  Call ben.SetItem(car_make, "Please enter make...")
  Call ben.SetItem(car_businessmiles, S_UNDER2499)
  Call ben.SetItem(car_Registrationdate, rates.GetItem(CarRegDateDef))
  
  ben.ReadFromDB = True
  
  I = CurrentEmployee.benefits.Add(ben)
  Set lst = LB.ListItems.Add(, , ben.Name)
  Set ibf = Me
  
  Call ibf.UpdateBenefitListViewItem(lst, ben, I, True)
  ben.Dirty = True
  
  'place to the screen
  Call ibf.BenefitToScreen(I)
  
 
AddBenefit_End:
  Set lst = Nothing
  Set ibf = Nothing
  Set ben = Nothing
  Call xReturn("AddBenefit")
  Exit Sub
AddBenefit_Err:
  Call ErrorMessage(ERR_ERROR, Err, "AddBenefit", "ERR_ADDBENEFIT", "Error in AddBenefit function, called from the form " & Me.Name & ".")
  Resume AddBenefit_End
  Resume
End Sub

Private Property Let IBenefitForm2_benefit(NewValue As IBenefitClass)
  Set benefit = NewValue
End Property

Private Property Get IBenefitForm2_benefit() As IBenefitClass
  Set IBenefitForm2_benefit = benefit
End Property

Private Function IBenefitForm2_BenefitFormState(ByVal fState As BENEFIT_FORM_STATE) As Boolean
On Error GoTo BenefitFormState_err
  Call xSet("IBenefitForm2_EnableBenefitForm")
  
  If (fState = FORM_ENABLED) Or (fState = FORM_CDB) Then
    If fState = FORM_ENABLED Then
      fmeCar.Enabled = True
    Else
      ECASE ("Car CBD?") 'CAD
    End If
    LB.Enabled = True
    Call MDIMain.SetDelete
  ElseIf fState = FORM_DISABLED Then
    Set benefit = Nothing
    fmeCar.Enabled = False 'new
    LB.Enabled = False 'new
    Call MDIMain.ClearDelete
    Call MDIMain.ClearConfirmUndo
  End If
  
  IBenefitForm2_BenefitFormState = True
    
BenefitFormState_end:
  Call xReturn("BenefitFormState")
  Exit Function
  
BenefitFormState_err:
  IBenefitForm2_BenefitFormState = False
  Call ErrorMessage(ERR_ERROR, Err, "BenefitFormState", "ERR_UNDEFINED", "Undefined error.")
  Resume BenefitFormState_end
End Function

Private Function IBenefitForm2_BenefitsToListView() As Long
  IBenefitForm2_BenefitsToListView = BenefitsToListView(Me)
End Function

Private Function IBenefitForm2_BenefitToScreen(Optional ByVal BenefitIndex As Long = -1&, Optional ByVal UpdateBenefit As Boolean = True) As IBenefitClass
  Dim lst As ListItem
  Dim ben As IBenefitClass, tmpben As IBenefitClass
  Dim ibf As IBenefitForm2
  Dim I As Long
  
On Error GoTo BenefitToScreen_Err
  Call xSet("BenefitToScreen")
  
  Set ibf = Me
  If UpdateBenefit Then Call UpdateBenefitFromTags
  If BenefitIndex <> -1 Then
    Set ben = CurrentEmployee.benefits(BenefitIndex)
    If ben.BenefitClass <> m_bentype Then Call Err.Raise(ERR_INVALIDBENTYPE, "BenefitToScreen", "Benefit type invalid.")
  
    Set IBenefitForm2_BenefitToScreen = ben
    Set benefit = ben
    
    TB_Data(0).Text = ben.GetItem(car_Registration)
    TB_Data(1).Text = ben.GetItem(car_ListPrice)
    TB_Data(2).Text = DateStringEx(ben.GetItem(car_Availablefrom), ben.GetItem(car_Availablefrom))
    TB_Data(3).Text = DateStringEx(ben.GetItem(car_Availableto), ben.GetItem(car_Availableto))
    TB_Data(4).Text = ben.GetItem(car_Unavailabledays)
    TB_Data(5).Text = ben.GetItem(car_capitalcontribution)
    TB_Data(6).Text = ben.GetItem(car_usagecontribution)
    TB_Data(7).Text = ben.GetItem(car_make)
    TB_Data(8).Text = DateStringEx(ben.GetItem(car_Registrationdate), ben.GetItem(car_Registrationdate))
    lblFuel.Caption = Format$(ben.GetItem(car_FuelBenefit), "£#,##0")
    Op_Data(0) = IIf(ben.GetItem(car_UseActualMiles), vbChecked, vbUnchecked)
    Op_Data(1) = IIf(ben.GetItem(car_Replaced), vbChecked, vbUnchecked)
    Op_Data(2) = IIf(ben.GetItem(car_Second), vbChecked, vbUnchecked)
    
    'Add these cars to an object list
    CB_CARLIST.Clear
    
    For I = 1 To CurrentEmployee.benefits.count
      Set tmpben = CurrentEmployee.benefits(I)
      If Not (tmpben Is Nothing) Then
        If tmpben.BenefitClass = BC_COMPANYCAR And Not tmpben Is benefit Then
          If TryConvertDateDMY(tmpben.GetItem(car_Availableto)) < TryConvertDateDMY(benefit.GetItem(car_Availablefrom)) Then
            CB_CARLIST.AddItem (tmpben.Name)
            CB_CARLIST.ItemData(CB_CARLIST.ListCount - 1) = I
          End If
        End If
      End If
    Next I
    
    Op_Data(3) = IIf(ben.GetItem(car_Replacement), vbChecked, vbUnchecked)
    Call ReplacementCarVisible(ben.GetItem(car_RegReplaced), Op_Data(3))
    Op_Data(4) = IIf(ben.GetItem(car_PrintMakeOnP46), vbChecked, vbUnchecked)
    Op_Data(5) = IIf(ben.GetItem(car_ForceP46), vbChecked, vbUnchecked)
    Call GetMiles(ben, True)
    lblAccessories = ben.GetItem(car_accessories)
  Else
    TB_Data(0).Text = ""
    TB_Data(1).Text = ""
    TB_Data(2).Text = ""
    TB_Data(3).Text = ""
    TB_Data(4).Text = ""
    TB_Data(5).Text = ""
    TB_Data(6).Text = ""
    TB_Data(7).Text = ""
    TB_Data(8).Text = ""
    '.TB_Data(9).Text = ben.GetItem()
    lblFuel.Caption = ""
    Op_Data(0) = vbUnchecked
    Op_Data(1) = vbUnchecked
    Op_Data(2) = vbUnchecked
    Op_Data(3) = vbUnchecked
    Call ReplacementCarVisible("", Op_Data(3))
    Op_Data(5) = vbUnchecked
    CB_CARLIST.Clear
    
    lblAccessories = ""
  End If
  Call SetBenefitFormState(ibf, ben)
  
BenefitToScreen_End:
  Set tmpben = Nothing
  Set ibf = Nothing
  Set lst = Nothing
  Set ben = Nothing
  Call xReturn("BenefitToScreen")
  Exit Function
BenefitToScreen_Err:
  
  Call ErrorMessage(ERR_ERROR, Err, "BenefitToScreen", "ERR_BenefitToScreen", "Error loading the car details onto the form.")
  Resume BenefitToScreen_End
  Resume
End Function
Private Property Let IBenefitForm2_bentype(ByVal NewValue As benClass)
  m_bentype = NewValue
End Property

Private Property Get IBenefitForm2_bentype() As benClass
  IBenefitForm2_bentype = m_bentype
  
End Property

Private Property Get IBenefitForm2_lv() As ComctlLib.IListView
  Set IBenefitForm2_lv = LB
End Property

Private Function IBenefitForm2_RemoveBenefit(ByVal BenefitIndex As Long) As Boolean
  IBenefitForm2_RemoveBenefit = RemoveBenefit(Me, CurrentEmployee.benefits(BenefitIndex), BenefitIndex)
End Function

Private Function IBenefitForm2_UpdateBenefitListViewItem(li As ComctlLib.IListItem, benefit As IBenefitClass, Optional ByVal BenefitIndex As Long = 0&, Optional ByVal SelectItem As Boolean = False) As Boolean
   IBenefitForm2_UpdateBenefitListViewItem = UpdateBenefitListViewItem(li, benefit, BenefitIndex, SelectItem)
End Function

Private Function IFrmGeneral_CheckChanged(C As Control, ByVal UpdateCurrentListItem As Boolean) As Boolean
  Dim lst As ListItem
  Dim I As Long
  Dim bDirty As Boolean
  
  On Error GoTo CheckChanged_Err
  Call xSet("CheckChanged")
  
  If CurrentEmployee Is Nothing Then GoTo CheckChanged_End
  If benefit Is Nothing Then GoTo CheckChanged_End
  
  With C
    Select Case .Name
      Case "TB_Data"
        Select Case .Index
          Case 0
            bDirty = CheckTextInput(.Text, benefit, car_Registration)
          Case 1
            bDirty = CheckTextInput(.Text, benefit, car_ListPrice)
          Case 2
            bDirty = CheckTextInput(.Text, benefit, car_Availablefrom)
          Case 3
            bDirty = CheckTextInput(.Text, benefit, car_Availableto)
          Case 4
            bDirty = CheckTextInput(.Text, benefit, car_Unavailabledays)
          Case 5
            bDirty = CheckTextInput(.Text, benefit, car_capitalcontribution)
          Case 6
            bDirty = CheckTextInput(.Text, benefit, car_usagecontribution)
          Case 7
            bDirty = CheckTextInput(.Text, benefit, car_make)
          Case 8
            bDirty = CheckTextInput(.Text, benefit, car_Registrationdate)
          Case 9
            'make for 46
            'bDirty = CheckTextInput(.Text, benefit, car_Registration)
            'i= StrComp(c.Text, benefit.GetItem(car_Registration), vbBinaryCompare)
            'if i <> 0 then Call benefit.SetItem(car_Registration, c.Text)
          Case 10
            'model for p46
          Case Else
            ECASE "Unknown control"
            GoTo CheckChanged_End
        End Select
      Case "Op_Data"
        Select Case C.Index
          Case 0
            'use actual miles boolean
            bDirty = CheckCheckBoxInput(C.value, benefit, car_UseActualMiles)
            Call GetMiles(benefit, True)
          Case 1
            bDirty = CheckCheckBoxInput(C.value, benefit, car_Replaced)
          Case 2
            bDirty = CheckCheckBoxInput(C.value, benefit, car_Second)
          Case 3
            bDirty = CheckCheckBoxInput(C.value, benefit, car_Replacement)
            Call ReplacementCarVisible(benefit.GetItem(car_RegReplaced), C)
          Case 4
            bDirty = CheckCheckBoxInput(C.value, benefit, car_PrintMakeOnP46)
          Case 5
            bDirty = CheckCheckBoxInput(C.value, benefit, car_ForceP46)
          Case Else
            ECASE "Unknown control"
            GoTo CheckChanged_End
        End Select
      Case "CB_BusMiles"
        bDirty = CheckTextInput(.Text, benefit, car_businessmiles)
      Case "L_Data"
        Select Case .Index
          Case 17
            'reg of replacemendt car changed
            bDirty = CheckTextInput(.Caption, benefit, car_RegReplaced)
            Call CheckTextInput(L_Data(14), benefit, car_CarReplaced)
            Call CheckTextInput(L_Data(15), benefit, car_dateReplaced)
        Case Else
        End Select
      Case Else
        ECASE "Unknown control"
        GoTo CheckChanged_End
    End Select
  End With
  IFrmGeneral_CheckChanged = AfterCheckChanged(C, Me, bDirty, UpdateCurrentListItem)
    
CheckChanged_End:
  Call xReturn("CheckChanged")
  Exit Function

CheckChanged_Err:
  Call ErrorMessage(ERR_ERROR, Err, "CheckChanged", "ERR_CHECKCHANGED", "This function has failed for the form " & Me.Name & ".")
  Resume CheckChanged_End
End Function

Private Function GetReplacementCar(ByVal ListIndex As Long) As Boolean
  Dim ben As IBenefitClass
  
On Error GoTo GetReplacementCar_ERR
  Call xSet("GetReplacementCar")
    
  If ListIndex <> -1 Then
    Set ben = CurrentEmployee.benefits(CB_CARLIST.ItemData(ListIndex))
    'try and select the first one
    'If CB_CARLIST.ListCount > 0 Then Set ben = CurrentEmployee.benefits(CB_CARLIST.ItemData(1))
    L_Data(17) = ben.GetItem(car_Registration)
    L_Data(14) = ben.GetItem(car_make) & " " & ben.GetItem(car_model)
    L_Data(15) = ben.GetItem(car_Availableto)
    Call IFrmGeneral_CheckChanged(L_Data(17), True)
  Else
    L_Data(17) = ""
    L_Data(14) = ""
    L_Data(15) = ""
  End If
  GetReplacementCar = True
  
GetReplacementCar_END:
  Call xReturn("GetReplacementCar")
  Exit Function
  
GetReplacementCar_ERR:
  GetReplacementCar = False
  Call ErrorMessage(ERR_ERROR, Err, "GetReplacementCar", "Get Replacement Car", "Error getting the replacement car from the cars object list. Index = " & ListIndex)
  Resume GetReplacementCar_END
  Resume
End Function
Private Function SetReplacementCarColor(ByVal lCol As Long) As Boolean

On Error GoTo SetReplacementCarColor_ERR
  
  Call xSet(" SetReplacementCarColor")
  
  If L_Data(17).ForeColor <> lCol Then
    L_Data(17).ForeColor = lCol
    L_Data(14).ForeColor = lCol
    L_Data(15).ForeColor = lCol
  End If
  
  SetReplacementCarColor = True
    
SetReplacementCarColor_END:
  Call xReturn(" SetReplacementCarColor")
  Exit Function
  
SetReplacementCarColor_ERR:
  SetReplacementCarColor = False
  Call ErrorMessage(ERR_ERROR, Err, " SetReplacementCarColor", "Get Replacement Car", "Error setting the replacement car details color.")
  Resume SetReplacementCarColor_END
  Resume
  
End Function

Private Function BlankReplacementCar() As Boolean

On Error GoTo BlankReplacementCar_ERR

  Call xSet("BlankReplacementCar")
  
  Call benefit.SetItem(car_RegReplaced, "")
  Call benefit.SetItem(car_CarReplaced, "")
  Call benefit.SetItem(car_dateReplaced, "")

  
  BlankReplacementCar = True
  
BlankReplacementCar_END:
  Call xReturn("BlankReplacementCar")
  Exit Function
BlankReplacementCar_ERR:
  BlankReplacementCar = False
  Call ErrorMessage(ERR_ERROR, Err, "BlankReplacementCar", "Blank Replacement Car", "Error setting the replacement cars details to zero length strings.")
  Resume BlankReplacementCar_END
End Function

Private Function ReplacementCarVisible(sCurrentReg As String, cB As CheckBox) As Boolean
  Dim l As Long
  Dim bFound As Boolean
  
  
On Error GoTo ReplacementCarVisible_ERR
  
  Call xSet("ReplacementCarVisible")
  
  If cB.value = vbChecked Then
    If CB_CARLIST.ListCount Then
      CB_CARLIST.Visible = True
      'data
      L_Data(14).Visible = True
      L_Data(15).Visible = True
      L_Data(17).Visible = True
      'titles
      L_Data(18).Visible = True
      L_Data(5).Visible = True
      L_Data(11).Visible = True
      L_Data(16).Visible = True
      'has one been in the system before
      'Make on p46
      Op_Data(4).Visible = True
      
      If Len(sCurrentReg) Then
        For l = 0 To CB_CARLIST.ListCount - 1
          If StrComp(sCurrentReg, CB_CARLIST.List(l)) = 0 Then
              CB_CARLIST.Text = sCurrentReg
              bFound = True
            Exit For
          End If
        Next
        If bFound Then
          'yes so select it in the combo box
           Call GetReplacementCar(l)
        Else
          'give warning to the user that their previous car is not available
          Call ErrorMessage(ERR_INFO, Err, "ReplacementCarVisible", "Replacement Car Visible", "The car with registration number of " & benefit.GetItem(car_RegReplaced) & " is no longer available please check available cars. Selecting the first available car")
          Call GetReplacementCar(0) 'select th first one
        End If
      Else
        'there has not been a previous car so select the first in the combo
        Call GetReplacementCar(0)
      End If
    Else
      Call ErrorMessage(ERR_INFO, Err, "ReplacementCarVisible", "Replacement Car Visible", "There are no replacement cars available. Please check the available to and from date for the current car and the car you wish to replace.")
      Op_Data(3).value = vbUnchecked
    End If
  Else
    CB_CARLIST.Visible = False
    CB_CARLIST.Text = ""
    
    L_Data(14) = ""
    L_Data(15) = ""
    L_Data(17) = ""
    
    L_Data(14).Visible = False
    L_Data(15).Visible = False
    L_Data(17).Visible = False
    L_Data(18).Visible = False
    L_Data(5).Visible = False
    L_Data(11).Visible = False
    L_Data(16).Visible = False
    'print make on p46
    Op_Data(4).Visible = False
  End If
  
ReplacementCarVisible_END:
  Call xReturn("ReplacementCarVisible")
  Exit Function
ReplacementCarVisible_ERR:
  ReplacementCarVisible = False
  Call ErrorMessage(ERR_ERROR, Err, "ReplacementCarVisible", "Replacement Car Visible", "Error setting the controls for the replacement car flag.")
  Resume ReplacementCarVisible_END
  Resume
  
End Function

Private Property Get IFrmGeneral_InvalidVT() As TCSValidationText.ValText
  Set IFrmGeneral_InvalidVT = m_InvalidVt
End Property

Private Property Set IFrmGeneral_InvalidVT(NewValue As TCSValidationText.ValText)
  Set m_InvalidVt = NewValue
End Property



Private Sub LB_ItemClick(ByVal Item As ComctlLib.ListItem)
  
  Call SetLastListItemSelected(Item)
  If mLastClickIndex = Item.Index Then
    mLastClickIndex = -1
  Else
    If Not (LB.SelectedItem Is Nothing) Then
      Call IBenefitForm2_BenefitToScreen(Item.Tag)
    End If
    mLastClickIndex = Item.Index
  End If
End Sub

Private Sub LB_ColumnClick(ByVal ColumnHeader As ComctlLib.ColumnHeader)
  LB.SortKey = ColumnHeader.Index - 1
  LB.SelectedItem.EnsureVisible
End Sub

Private Sub LB_KeyPress(KeyAscii As Integer)
  'Check for return key - tab to next field
  If KeyAscii = 13 Then Call SendKeys(vbTab)
End Sub

Private Sub Op_Data_Click(Index As Integer)
  Call IFrmGeneral_CheckChanged(Op_Data(Index), True)
End Sub

Private Sub Op_Data_KeyPress(Index As Integer, KeyAscii As Integer)
  'Check for return key - tab to next field
  If KeyAscii = 13 Then Call SendKeys(vbTab)
End Sub


Private Sub TB_Data_FieldInvalid(Index As Integer, Valid As Boolean, Message As String)
  Call MDIMain.sts.SetStatus(0, Message)
End Sub

Private Sub TB_Data_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
  TB_Data(Index).Tag = SetChanged
End Sub

Private Sub TB_data_Lostfocus(Index As Integer)
  Call IFrmGeneral_CheckChanged(TB_Data(Index), True)
End Sub

Private Sub Op_Data_LostFocus(Index As Integer)
  Call IFrmGeneral_CheckChanged(Op_Data(Index), True)
End Sub

